# Final exercises

The following sets of exercises aim to help you practice what was learned during this workshop.
<br>

Exercise A: barplot
<br>
Exercise B: scatter plot
<br>
Exercise C: boxplot
<br>

## Exercise A: barplots

1. Import **DataViz_source_files-main/files/population_age_group_per_sex_long_format.csv** into an object called **pop_age**.

<details>
<summary>
correction
</summary>

```{r}
pop_age <- read_csv("DataViz_source_files-main/files/population_age_group_per_sex_long_format.csv")
```

</details>


2. Create a barplot that shows the number of people per **Year**:


<details>
<summary>
correction
</summary>

```{r}
ggplot(data=pop_age, mapping=aes(x=Year, y=Population)) + 
  geom_bar(stat="identity")
```

</details>


3. Split the view by Sex:


<details>
<summary>
correction
</summary>

```{r}
ggplot(data=pop_age, mapping=aes(x=Year, y=Population, fill=Sex)) + 
  geom_bar(stat="identity")
```

</details>


4. Select only "Spain" in "Country":

  
<details>
<summary>
correction
</summary>

```{r}
ggplot(data=filter(pop_age, Country=="Spain"), mapping=aes(x=Year, y=Population, fill=Sex)) + 
  geom_bar(stat="identity")
```

</details>


5. Show the bars next to each other.

<details>
<summary>
correction
</summary>

```{r}

ggplot(data=filter(pop_age, Country=="Spain"), mapping=aes(x=Year, y=Population, fill=Sex)) + 
  geom_bar(stat="identity", position="dodge")
```

</details>



6. Change default colors using **scale_fill_manual()** layer.

The structure is not easy to remember: take a peek at the answer!

  
<details>
<summary>
correction
</summary>

```{r}
ggplot(data=filter(pop_age, Country=="Spain"), mapping=aes(x=Year, y=Population, fill=Sex)) + 
  geom_bar(stat="identity", position="dodge") + 
  scale_fill_manual(values=c("darkgreen", "red"))
```

</details>


7. Add a title, change the theme / background:

<details>
<summary>
correction
</summary>

```{r}
ggplot(data=filter(pop_age, Country=="Spain"), mapping=aes(x=Year, y=Population, fill=Sex)) +
  geom_bar(stat="identity", position="dodge") + 
  scale_fill_manual(values=c("darkgreen", "red")) + 
  ggtitle("Spanish population from 1950 to 2021 per sex") + 
  theme_minimal()
```

</details>

8. Save to a PDF file: Export -> Save as PDF. Note: when saving to PDF format, you cannot manualy drag the plot to get the size and proportion you want, but you can **Preview** before saving it.

9. Only if you have time!

* Select data from **Italy** and for the year **2000**. 
* Create a barplot that shows **Sex** in **y**, Population in **y** and that is split by the **Age_group**.
* Show the proportions (remember: position="fill")

<details>
<summary>
correction
</summary>

```{r}
ggplot(data=filter(pop_age, Country=="Spain" & Year==2000), mapping=aes(x=Sex, y=Population, fill=Age_group)) + 
  geom_bar(stat="identity", position="dodge")
```

</details>

## Exercise B: scatter plot

1. Import **DataViz_source_files-main/files/GSE150029_rnaseq_log2.csv** into an object called **rnaseq**.

<details>
<summary>
correction
</summary>

```{r}
rnaseq <- read_csv("DataViz_source_files-main/files/GSE150029_rnaseq_log2.csv")
```

</details>

2. Create a scatter plot that represents sample CTRL on the x axis and sample EZH on the y axis.

<details>
<summary>
correction
</summary>

```{r}
ggplot(data=rnaseq, mapping=aes(x=CTRL, y=EZH)) +
  geom_point()
```

</details>

<br>
3. Color the points according to the **gene_biotype**

<details>
<summary>
correction
</summary>

```{r, fig.width=16}
ggplot(data=rnaseq, mapping=aes(x=CTRL, y=EZH, color=gene_biotype)) +
  geom_point()
```

</details>

<br>
3. Not very readable! Filter and plot only data corresponding to lincRNA and miRNA.

<details>
<summary>
correction
</summary>

```{r}
ggplot(data=filter(rnaseq, gene_biotype=="lincRNA" | gene_biotype=="miRNA"), mapping=aes(x=CTRL, y=EZH, color=gene_biotype)) +
  geom_point()
```

</details>

<br>
4. Now select and only those lincRNAs and miRNAs that are expressed in CTRL at least 1.5 times more than in EZH.

<details>
<summary>
correction
</summary>

```{r}
ggplot(data=filter(rnaseq, gene_biotype=="lincRNA" | gene_biotype=="miRNA" & CTRL > 1.5*EZH), mapping=aes(x=CTRL, y=EZH, color=gene_biotype)) +
  geom_point()
```

</details>



## Exercise C: boxplot

1. Import **DataViz_source_files-main/files/GSE150029_rnaseq_log2_long.csv** into an object called **rnaseq2**.

<details>
<summary>
correction
</summary>

```{r}
rnaseq2 <- read_csv("DataViz_source_files-main/files/GSE150029_rnaseq_log2_long.csv")
```

</details>

Note that the information contained in that file is the same as for the previous exercise, but in a different format: this one is in a so-called **long** format, i.e. one observation (value) per row.

2. Create a boxplot that will represent the samples on the x axis, and their expression on the y axis.

<details>
<summary>
correction
</summary>

```{r}
ggplot(data=rnaseq2, mapping=aes(x=sample, y=log2_counts)) + 
  geom_boxplot()
```

</details>

<br>

3. Split the boxes per gene_biotype.

<details>
<summary>
correction
</summary>

```{r, fig.width=18}
ggplot(data=rnaseq2, mapping=aes(x=sample, y=log2_counts, fill=gene_biotype)) + 
  geom_boxplot()
```

</details>

4. Select only protein_coding and lincRNA and split again the boxes per gene_biotype.

<details>
<summary>
correction
</summary>

```{r}
ggplot(data=filter(rnaseq2, gene_biotype=="protein_coding" | gene_biotype=="lincRNA"), mapping=aes(x=sample, y=log2_counts, fill=gene_biotype)) + 
  geom_boxplot()
```

</details>

<br>

4. Produce a different view from this boxplot: set the gene_biotype on the x axis, and split by sample.

<details>
<summary>
correction
</summary>

```{r}
ggplot(data=rnaseq2, mapping=aes(x=gene_biotype, y=log2_counts, fill=sample)) + 
  geom_boxplot()
```

</details>



